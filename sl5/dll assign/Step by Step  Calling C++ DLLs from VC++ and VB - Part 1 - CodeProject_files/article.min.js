function copyCode(){try{var c=document.selection.createRange();if(document.selection.type!="none"){var d=c.parentElement();var g=d.tagName;if(g!=null){if(g.toLowerCase()=="pre"){var a=/<br[^>]*>/gi;var b=c.htmlText.replace(a,"\r\n");a=/&nbsp;/gi;b=b.replace(a," ");a=/&amp;/gi;b=b.replace(a,"&");a=/&lt;/gi;b=b.replace(a,"<");a=/&gt;/gi;b=b.replace(a,">");a=/<\/?span([^>])*>/gi;b=b.replace(a,"");if(b!=null){window.event.returnValue=false;window.clipboardData.setData("Text",b)}}}}}catch(f){}}if(document.all){try{window.attachEvent("oncopy",copyCode)}catch(e){}}function WrapMe(f,h,d,k){var l;var c="";var b=0;var g=f.toLowerCase();var a=h.length;h=h.toLowerCase();while((l=g.indexOf(h,b))>=0){c+=f.substr(b,l-b);c+=d+f.substr(l,a)+k;b=l+a}c+=f.substr(b);return c}function markText(g,b){var d='<span class="search-highlight">';var h="</span>";var a=new RegExp("(<[^>][^<]*>)([^<]*)","g");var f;var c=new String("");while((f=a.exec(b.toString()))!=null){c+=f[1];c+=WrapMe(f[2],g,d,h)}return c}function unmarkText(b,a){elemObj=document.getElementById(b);if(elemObj){var c=new RegExp('<span class="?search-highlight"?>([^<]*)?</span>',"gi");elemObj.parentNode.innerHTML=elemObj.parentNode.innerHTML.replace(c,"$1")}if(a){elemObj=document.getElementById(a);if(elemObj){elemObj.className+=" hidden"}}}function markTextInElement(a,b){elemObj=document.getElementById(b);if(elemObj){elemObj.parentNode.innerHTML=markText(a,elemObj.parentNode.innerHTML)}}function social(){this.txtVersion="1.2";this.addtoInterval=null;this.popupWin="";this.addtoMethod=1;this.AddTitle=null;this.AddURL=null;this.Horizontal=false;this.Showname=false;this.ObjectTypeId=0;this.ObjectId=0;this.PlaceholderId="";this.sns=[{name:"Twitter",image:"AddTo_Twitter.gif",url:"http://twitter.com/home?",urlVar:"status",titleVar:"",noteVar:"",urlPre:"Currently reading ",returnVar:"",otherVars:""},{name:"Digg",image:"AddTo_Digg.png",url:"http://digg.com/submit?",urlVar:"url",titleVar:"",noteVar:"",urlPre:"",returnVar:"",otherVars:"&phase=2"},{name:"Facebook",image:"AddTo_Facebook.png",url:"http://www.facebook.com/sharer.php?",urlVar:"u",titleVar:"t",noteVar:"",urlPre:"",returnVar:"",otherVars:""},{name:"Del.icio.us",image:"AddTo_Delicious.png",url:"http://del.icio.us/post?",urlVar:"url",titleVar:"title",noteVar:"",urlPre:"",returnVar:"",otherVars:""},{name:"Reddit",image:"AddTo_Reddit.png",url:"http://reddit.com/submit?",urlVar:"url",titleVar:"title",noteVar:"",urlPre:"",returnVar:"",otherVars:""},{name:"Stumbleupon",image:"AddTo_stumbleupon.png",url:"http://www.stumbleupon.com/submit?",urlVar:"url",titleVar:"title",noteVar:"",urlPre:"",returnVar:"",otherVars:""},{name:"Newsvine",image:"AddTo_Newsvine.png",url:"http://www.newsvine.com/_wine/save?",urlVar:"u",titleVar:"",noteVar:"",urlPre:"",returnVar:"",otherVars:"&popoff=0"},{name:"Technorati",image:"AddTo_Technorati.png",url:"http://technorati.com/faves?",urlVar:"add",titleVar:"",noteVar:"",urlPre:"",returnVar:"",otherVars:""},{name:"Mr. Wong",image:"AddTo_MrWong.png",url:"http://www.mister-wong.com/index.php?",urlVar:"bm_url",titleVar:"bm_description",noteVar:"",urlPre:"",returnVar:"",otherVars:"&action=addurl"},{name:"Yahoo!",image:"AddTo_Yahoo.png",url:"http://myweb2.search.yahoo.com/myresults/bookmarklet?",urlVar:"u",titleVar:"t",noteVar:"",urlPre:"",returnVar:"",otherVars:"&d=&ei=UTF-8"},{name:"Google",image:"AddTo_Google.png",url:"http://www.google.com/bookmarks/mark?",urlVar:"bkmk",titleVar:"title",noteVar:"",urlPre:"",returnVar:"",otherVars:"&op=edit"},{name:"Windows Live",image:"AddTo_Live.png",url:"https://favorites.live.com/quickadd.aspx?",urlVar:"url",titleVar:"title",noteVar:"",urlPre:"",returnVar:"",otherVars:"&marklet=1&mkt=en-us&top=1"},{name:"Send as Email",image:"envelope.gif",url:"/script/common/TellFriend.aspx?obtid={0}&obid={1}&",urlVar:"",titleVar:"",noteVar:"",prefix:"",returnVar:"",otherVars:""}];this.DrawLink=function(a,c,d){var f=(c==(this.sns.length-1))?"":"Add this page to ";var b='<a class="'+d+'" title="'+f+this.sns[c].name+'" onclick="return '+a+".addto("+c.toString()+');" href="#"><img align="absmiddle" src="/images/'+this.sns[c].image+'" width="16px" height="16px" border="0" /> ';if(this.Showname){b+=this.sns[c].name}return b+"</a> "};this.setupLinks=function(f,a,d,g,l,h,b){var k="";this.AddTitle=d;this.AddURL=a;if(g>this.sns.length){if(this.Horizontal){k+='<span class="'+h+'">Add this article to: </span> '}for(var c=0;c<this.sns.length;c++){if(!this.Horizontal){k+="<div>"}k+=this.DrawLink(f,c,b);k+=(this.Horizontal?" ":"</div>")}}else{k+='<table width="'+l.toString()+'" border="0" cellspacing="0" cellpadding="0"><tr><tr><td colspan="'+g.toString()+'" class="'+h+'" height="20">Add this article to:</td></tr>\n';for(var c=0;c<this.sns.length;c++){k+='<td valign="middle">';k+=this.DrawLink(f,c,b);k+="</td>";if((((c+1)%g)==0)&&(c!=(this.sns.length-1))){k+="</tr><tr>"}}k+="</td></tr></table>"}if($("#ATD")[0]){$("#ATD")[0].innerHTML=k}};this.addtoWin=function(a){if(this.popupWin&&!this.popupWin.closed&&this.popupWin.location){this.popupWin.location.href=a}else{this.popupWin=window.open(a,"addtoPopUp","width=770px,height=500px,menubar=1,toolbar=1,status=1,location=1,resizable=1,scrollbars=1,left=0,top=100");if(!this.popupWin.opener){this.popupWin.opener=self}}if(window.focus){this.popupWin.focus()}return false};this.closeAddTo=function(){if(!this.popupWin.closed&&this.popupWin.location){if(this.popupWin.location.href==this.AddURL){this.popupWin.close()}}else{clearInterval(this.addtoInterval);return true}};this.addto=function(b){if(!this.AddURL){this.AddURL=document.location.href}if(!this.AddTitle){this.AddTitle=escape(document.title)}var a=this.sns[b].url.replace("{0}",this.ObjectTypeId.toString());a=a.replace("{1}",this.ObjectId.toString());var c=a;c+=this.sns[b].urlVar+"="+escape(this.sns[b].urlPre)+this.AddURL;if(this.sns[b].titleVar!=""){c+="&"+this.sns[b].titleVar+"="+this.AddTitle}c+=this.sns[b].otherVars;if(this.sns[b].noteVar!=""){c+="&"+this.sns[b].noteVar+"="+this.AddTitle}if(this.sns[b].returnVar!=""){c+="&"+this.sns[b].returnVar+"="+this.AddURL}switch(this.addtoMethod){case 0:self.location=c;break;case 1:this.addtoWin(c);break;default:}return false};this.setupMenu=function(){var a=false;$(document).ready(function(){var k=$("#SBI"),d=$("#ATD");if(!k||!d){return}var b=$(k).position();var l=$(k).outerWidth();var c=$(d).outerWidth();var g=$(k).outerHeight();var f=(b.left+(l-c)/2)+"px";var h=g+b.top+"px";$(d).css({left:f,top:h});$(k).hover(function(){$(d).stop(true,true).fadeIn("fast")},function(){setTimeout(function(){if(!a){$("#ATD").fadeOut("fast")}},200)});$(d).hover(function(){a=true},function(){a=false;$(d).fadeOut("fast")})})}}function InitWatermark(c,b){var a=$("#"+c);if(!a){return}a.blur(function(){UpdateWatermark(this,b)});a.focus(function(){UpdateWatermark(this,b)});var d=$.trim(a.val());if(d==""||d==b){a.val(b);a.addClass("subdue")}else{if(d!=""&&d!=b){a.removeClass("subdue")}}}function UpdateWatermark(a,b){if(!a){return}var c=$.trim($(a).val());if(c==b&&$(a).hasClass("subdue")){$(a).val("");$(a).removeClass("subdue")}else{if(c==""&&!$(a).hasClass("subdue")){$(a).val(b);$(a).addClass("subdue")}else{$(a).removeClass("subdue")}}}var keyMapping=[];keyMapping["13"]="ENTER";keyMapping["37"]="LEFT";keyMapping["38"]="UP";keyMapping["39"]="RIGHT";keyMapping["40"]="DOWN";keyMapping["16"]="SHIFT";keyMapping["17"]="CTRL";keyMapping["33"]="PGUP";keyMapping["34"]="PGDOWN";var commandMapping={Combinations:{"CTRL+ENTER":function(){Submit()},"CTRL+LEFT":function(){MoveToPost(false,false)},"CTRL+RIGHT":function(){MoveToPost(true,false)},"CTRL+UP":function(){MoveToPost(false,true)},"CTRL+DOWN":function(){MoveToPost(true,true)},"CTRL+PGUP":function(){MoveToPage(true)},"CTRL+PGDOWN":function(){MoveToPage(false)}}};document.onkeydown=function(a){return shortcutEventHandler(a,commandMapping,keyMapping)};function getControlKeys(a){var b="";if(a.ctrlKey){b+="CTRL+"}if(a.shiftKey){b+="SHIFT+"}if(a.altKey){b+="ALT+"}return b}function shortcutEventHandler(f,g,c){if(!f){f=event}var d=(f.keyCode)?f.keyCode:f.charCode;var b="";if(c[d]){b=c[d]}var a=getControlKeys(f);b=a+b;if(g.Combinations[b]){g.Combinations[b]();if(f.preventDefault){f.preventDefault()}else{f.returnValue=false}if(f.stopPropagation){f.stopPropagation()}else{f.cancelBubble=true}return false}return true}function Submit(){var a=document.forms.aspnetForm;if(!a){a=document.aspnetForm}if(a){a.submit()}}function MoveToPage(b){var a=document.getElementById(b?"_mbpUrl":"_mbnUrl");if(a){location.href=a.value}}function MoveToPost(g,n){if(Selected==""||isNaN(Selected)){return}var c=document.getElementById("ForumTable");if(!c){return}var l=getElementsByClass("MsgHd",c,"tr");if(!l){return}var a=null;var k=parseInt(Selected);var b=-1;var f=0;for(var d=0;d<l.length;++d){var h=l[d].id.substring(1,l[d].id.length-3);h=parseInt(h);if(IsThreadHead(l[d])){f=d}if(h==k){b=d;break}}var m=null;for(var d=b+(g?1:-1);d<l.length&&d>=0;g?++d:--d){if((n&&IsThreadHead(l[d]))||!n){m=l[d].id.substring(1,l[d].id.length-3);m=parseInt(m);break}}if(m&&m!=parseInt(Selected)){SwitchMessage(null,m)}}function IsThreadHead(a){return a.className.indexOf("Rt")>=0}function getElementsByClass(a,d,b){var f=new Array();if(d==null){d=document}if(b==null){b="*"}var h=d.getElementsByTagName(b);var g=h.length;var c=new RegExp("(^|\\s)"+a+"(\\s|$)");for(i=0,j=0;i<g;i++){if(c.test(h[i].className)){f[j]=h[i];j++}}return f}function rateItem(l,k,b,h,c,g,f){if(l>0&&k>0){var a=$("div[name=RateItem_"+l+"]").find("input[type=radio]:checked").val();var d=$("[name=RateItem_"+l+"] .RateComment")[0];if(d){d=d.value.replace(/^\s+|\s+$/g,"")}else{d=""}if(a<=0){ShowErrorMessage("You must select a value to vote",l)}else{if(a<=g&&d==""&&h&&c){ShowErrorMessage("You must provide a comment",l)}else{if(c||a>g){PrepElements(l);$.get("/Script/Ratings/Ajax/RateItem.aspx?obid="+l+"&obtid="+k+"&obstid="+b+"&rvv="+a+"&rvc="+escape(d)+(f?"&rdm="+f:""),function(m){callback(m,l)})}}}}return false}function callback(b,a){if(b.length>0){var c=$("div[name=RateItem_"+a+"] .voteRes")[0];if(c){c.innerHTML=b;c.style.display=""}c=$("[name=CurRat_"+a+"]")[0];if(c){c.style.display="none"}}var d=$("div[name=RateItem_"+a+"] .loaderImg")[0];$("div[name=RateItem_"+a+"] .ajaxHist").remove();if(d&&d.style){d.style.display="none"}}function PrepElements(b){var a=$("div[name=RateItem_"+b+"] .loaderImg")[0];if(a&&a.style.display=="none"){a.style.display=""}a=$("div[name=RateItem_"+b+"] .voteTbl")[0];if(a){a.style.display="none"}a=$("div[name=RateItem_"+b+"] .voteRes")[0];if(a){a.style.display="none"}a=$("div[name=RateItem_"+b+"] .rating-comment")[0];if(a){a.style.display="none"}}function ShowErrorMessage(b,a){var c=$("div[name=RateItem_"+a+"] .loaderImg")[0];if(c){c.style.display="none"}}function bookmarkMe(a,g,c,b){var h="bm_";var f=GetBmkLink(h,a.toString(),g.toString());var d=GetBmkStatusMsg(h,a.toString(),g.toString());if(LoadWaitMessage(f,d,b)){$(d).load(c)}return false}function watchMe(a,g,c,b){var h="bmw_";var f=GetBmkLink(h,a.toString(),g.toString());var d=GetBmkStatusMsg(h,a.toString(),g.toString());if(LoadWaitMessage(f,d,b)){$(d).load(c)}return false}function GetBmkLink(b,c,a){return $("a[name="+b+c+"_"+a+"]")}function GetBmkStatusMsg(b,c,a){return document.getElementsByName(b+c+"_"+a)[0]}function LoadWaitMessage(b,c,a){if(!b||!c){return false}$(b).css("display","none");if(a){$(c).html('<img src="/images/loading.gif" width="24px" height="24px" border="0" class="align-top">')}else{$(c).html('<img src="/images/animated_loading_blue.gif" width="16px" height="16px" border="0">')}$(c).css("display","");return true}(function(b){function a(){var f,c,d;f="";for(d=0;d<32;d++){if(d==8||d==12||d==16||d==20){f=f+"-"}c=Math.floor(Math.random()*16).toString(16).toUpperCase();f=f+c}return f}jQuery.fn.AdSigniaAd=function(d){var c=a();this.each(function(l){var g=this;var m={};m.channel=b(this).attr("lqm_channel");m.publisher=b(this).attr("lqm_publisher");m.zone=b(this).attr("lqm_zone");m.format=b(this).attr("lqm_format");var k=b(this).attr("lqm_country");if(k!=undefined){m.country=k}var f=b(this).attr("lqm_tags");if(f!=undefined){m.tags=f}m.ypos=b(this).offset().top;m.pageid=c;m.ct=l+1;m.renderhtml=true;m.target="_blank";var h=d+"?&"+b.param(m);b(this).attr("src",h)})}})(jQuery);var pOpen=new Image();var pClose=new Image();var PreCopy=new Image();pOpen.src="/images/plus.gif";pClose.src="/images/minus.gif";PreCopy.src="/images/copy_16.png";var canCopy=document.all;function togglePre(){var a=this.getAttribute("preid");var d=$("#pre"+a)[0];var b=$("#preimg"+a)[0];var c=$("#precollapse"+a)[0];if(d.style.display!="none"){if(document.all){c.innerText=" Expand"}else{$("#premain"+a).addClass("small-text pre-action-link align-right");c.firstChild.nodeValue=" Expand"}d.style.display="none";b.setAttribute("src",pOpen.src)}else{if(document.all){c.innerText=" Collapse"}else{$("#premain"+a).addClass("small-text align-right");c.firstChild.nodeValue=" Collapse"}d.style.display="block";b.setAttribute("src",pClose.src)}}function CopyCode(d){if(!canCopy){return false}var b=this.getAttribute("preid");if(b<0){return false}var c=$("#pre"+b.toString())[0];if(!c){return false}var a=c.innerHTML;if(!a){return}a=prepareCopyText(a);window.clipboardData.setData("Text",a);return false}function InitTogglePre(){var a=$("#contentdiv")[0];if(!a){return}var k=a.getElementsByTagName("pre");for(var b=0;b<k.length;b++){if(k[b].decoration&&k[b].decoration.toLowerCase()=="none"){continue}var f=k[b].parentNode;var h=k[b].innerHTML.length;var g=h-k[b].innerHTML.replace(/\n/ig,"").length+(h-k[b].innerHTML.replace(/\<br/ig,"").length)/3;var c=document.createElement("div");c.className="small-text align-right";c.setAttribute("id","premain"+b.toString());c.setAttribute("width","100%");c.setAttribute("style","display:block");var d=document.createElement("img");d.setAttribute("id","preimg"+b.toString());d.setAttribute("src",pClose.src);d.style.cursor="pointer";d.setAttribute("height",9);d.setAttribute("width",9);d.setAttribute("preid",b);d.onclick=togglePre;c.appendChild(d);d=document.createElement("span");d.setAttribute("id","precollapse"+b.toString());d.style.cursor="pointer";d.style.marginBottom=0;d.onclick=togglePre;d.setAttribute("preid",b);setText(d," Collapse");c.appendChild(d);if(canCopy){d=document.createElement("span");setText(d," | ");c.appendChild(d);d=document.createElement("a");setText(d,"Copy Code");d.href="#";d.setAttribute("preid",b);d.onclick=CopyCode;c.appendChild(d)}k[b].setAttribute("id","pre"+b.toString());k[b].style.marginTop=0;var f=k[b].parentNode;f.insertBefore(c,k[b])}}function prepareCopyText(b){if(!b){return null}var a=/<br[^>]*>/gi;var b=b.replace(a,"\r\n");a=/&nbsp;/gi;b=b.replace(a," ");a=/&amp;/gi;b=b.replace(a,"&");a=/&lt;/gi;b=b.replace(a,"<");a=/&gt;/gi;b=b.replace(a,">");a=/<\/?span([^>])*>/gi;b=b.replace(a,"");return b}function setText(a,b){if(typeof a.innerText!="undefined"){a.innerText=b}else{a.textContent=b}}InitTogglePre();